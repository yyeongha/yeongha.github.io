---
title: AI-DX education 3조_알약 프로젝트_2
categories: [Project] 
date: 2024-06-12
last_modified_at: 2024-06-12
---
# 오늘 해야할일
1. yolo 딱 맞게 자른 사진 학습해보기
2. yolo rembg 자른거 resnet에 넘겨주기
3. yolo랑 resnet 합치기
4. test_code2 폴더 3.10으로 변환해서 다시 올리기


# 1. yolo 딱 맞게 자른 사진 학습해보기

지금까지 나는 데이터 담당 조원분이 만드신 데이터를 사용하지 않고 내가 직접 roboflow에서 만들어서 사용했었다. 
그 이유는 나는 내가 훈련시킨 모델을 샘플 데이터로 학습시켜서 성능을 먼저 보려고 했기 때문이다. 
데이터 담당 조원분이 만드신 데이터는 최종 모델에 맞게 만들어주신 데이터라 모든 데이터(약 590메가)가 있기 때문에 학습하는데 오래 걸릴 것 같았다.
두번째로 모든 데이터를 조금씩 가져와서 샘플데이터를 만드는 방법이 있는데 왜 그 방법은 안했느냐? 그렇게 만들면 시간이 오래 걸릴 것 같았다. 샘플 폴더에 조금조금씩 train, valid, test를 옮기는데 시간이 너무 오래 걸릴 것 같았고, roboflow에 원천 데이터를 넣으면 자동으로 이미지 라벨링도 해주고 train, valid, test, data.yaml까지 자동으로 만들어주기 때문에 시간을 아끼고자 원천데이터를 활용해서 roboflow로 만든 데이터셋을 사용했었다.

내가 만든 데이터셋으로 yolov8을 테스트한 결과.. 
![noDetect]()
![noDetectPill]()

아무것도 감지하지 못함....

그래서 아무래도 이건 데이터에 문제가 있다고 판단을 했다.
이유1. yolo는 학습 코드를 튜닝해서 사용한것도 아니고 있는 그대로의 yolov8 모델에 epoch 200으로 학습을 시켰는데 안된 것은 데이터밖에 없다. 나는 train, valid, test 합쳐서 총 852개의 데이터로 에폭도 200으로 충분히 학습시켰기 때문에 감지를 못할수가 없다.
이유2. 나의 생각이지만 원천 데이터는 다양한 배경에서 여러개의 알약사진, 단일알약사진 등등 다양한 데이터로 학습시킨게 아니기 때문에 감지를 못했다.

-> 그래서 나는 roboflow에서 다른 사람들이 만든 알약 데이터를 가져와서 학습시키고 테스트 해보기로 했다.
https://universe.roboflow.com/project-qugef/ai-drug-analysis-service

이 데이터셋을 보면 
![roboData]()










어떻게 이럴수가.. 강사님에게 여쭤보니 나는 학습데이터를 정면에서 찍은 사진으로 학습을 했는데 해당 테스트 사진은 측면으로 기울어져 있어서 인식을 못한다고 하셨다. 
그래서 정면으로 찍힌 알약들을 테스트해봤는데
![pillDetect]()




dataset
    valid
    train
    test
    data.yaml

    results

    result_test
        detect_ima
        label
    rembg


/content/drive/MyDrive/Team3_pill/data/roboflow_test_dataset2/data_yolov8_test/test_pills_img/pills6.jpg : 테스트 이미지 (알약 여러개)


# 순서
* yolo 데이터로 훈련
valid, train, data.yaml 으로 훈련

* 테스트 (최종땐 빼고 이 부분을 rembg의 이미지, 라벨데이터로 만드는 기능으로 변경)
test_pills_img 가져와서 테스트
만약 여러개의 알약을 잘 인식했다면 성공
주의사항! : 우리 조 데이터는 위에서 찍은 알약 사진으로 학습했기 때문에 다른각도로 찍은 사진으로 테스트하면 성능이 안나옴!
테스트 확인할때 무조건 위에서 찍은 알약 사진으로 하기
테스트를 저장할때 label, detect_img 폴더에 각각 감지 이미지, 라벨 넣기


* rembg



























---